{% extends "chat/base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% load i18n %}
{% load custom_tags %}
{% get_current_language as LANGUAGE_CODE %}

{% block content %}
<div id="frame">
  <div id="sidepanel">
    <div id="profile">
      <div class="wrap">

	<audio id="sound">
	  <source src="{% static 'chat/bell.ogg' %}" type="audio/ogg">
	  <source src="{% static 'chat/bell.mp3' %}" type="audio/mpeg">
	</audio>
	<img id="profile-img" src="{% url 'user-img' request.user.id %}" class="offline" alt="" />
	<p id="user_name_{{ request.user.id }}">{{ request.user.first_name }} {{ request.user.last_name }}</p>
	<p id="unread_msgs_id" class="unread_msg_alert invisible">
	  <b>{% trans 'You have unread messages' %}</b>
	</p>
	<!-- i class="fa fa-chevron-down expand-button" aria-hidden="true"></i-->
	<div id="status-options">
	  <ul class="nolist">
	    <li id="status-away" class="active" onclick="chatns.update_status('away')">
	      <span class="status-circle">
		<div id="status_win">{% trans 'Away' %}</div></span>
	    </li>
	    <li id="status-busy" class="active" onclick="chatns.update_status('busy')">
	      <span class="status-circle">
		<div id="status_win">{% trans 'Busy' %}</div></span>
	    </li>
	    <li id="status-online" class="active" onclick="chatns.update_status('online')">
	      <span class="status-circle">
		<div id="status_win">{% trans 'Online' %}</div></span>
	    </li>
	    <li id="status-offline" class="active" onclick="chatns.update_status('offline')">
	      <span class="status-circle">
		<div id="status_win">{% trans 'Offline' %}</div></span>
	    </li>
	  </ul>
	</div>
	<!--div id="expanded">
	  <label for="twitter"><i class="fab fa-facebook-f" aria-hidden="true"></i></label>
	  <input name="twitter" type="text" value="mikeross" />
	  <label for="twitter"><i class="fab fa-twitter" aria-hidden="true"></i></label>
	  <input name="twitter" type="text" value="ross81" />
	  <label for="twitter"><i class="fab fa-instagram" aria-hidden="true"></i></label>
	  <input name="twitter" type="text" value="mike.ross" />
	</div-->
      </div>
    </div>
    <div id="search">
      <label for=""><i class="fa fa-search" aria-hidden="true"></i></label>
      <input type="text" placeholder="Search contacts..." />
    </div>
    <div id="contacts">
      <ul class="nolist" id="contact_list_id">
	<li id="contact_id_general" class="contact{% if not cur_user %} active{% endif %}" onclick="chatns.set_active(this, 'general')" style='padding:10px;'>
	  <div class="wrap">
	    <div class="meta">
	      <p class="name general_room">
		<i class="fas fa-home fa-2x" style="margin:-5px;"></i><div style="margin:-25px 0 0 45px;"><b>{% trans 'General' %}</b></div>
	      </p>
	    </div>
	  </div>
	</li>
	<li><hr></li>

	{% for u in users %}
	{% if u.id != request.user.id %}
	<li id="contact_id_{{ u.id}}" class="contact" onclick="chatns.set_active(this, {{ u.id }})">
	  <div class="wrap">
	    <span id="user_id_{{ u.id }}" class="contact-status {{ u.chat_status }}{% if cur_user %} active{% endif %}"></span>
	    <img id="user_img_{{ u.id }}" src="{% url 'user-img' u.id %}" alt="{{ u.first_name }} {{ u.last_name }}" />
	    <div class="meta">
	      <p id="user_name_{{ u.id }}" class="name">{{ u.first_name }} {{ u.last_name }}</p>
	      <p id="user_msg_preview_{{ u.id }}" class="preview"></p>
	    </div>
	  </div>
	</li>
	{% endif %}
	{% endfor %}
      </ul>
    </div>
    <div id="bottom-bar">
      <button onclick="chatns.add_channel();" id="addcontact">
	<i class="fa fa-user-plus fa-fw" aria-hidden="true"></i> <span>{% trans 'Add channel' %}</span></button>
      <button id="settings"><i class="fa fa-cog fa-fw" aria-hidden="true"></i> <span>Settings</span></button>
    </div>
  </div>
  <div class="content" onmouseout="chatns.has_focus=false" onmouseover="chatns.unread_msg_cur_user_clear()">
    <div style="position:absolute;margin:-1000px -1000px;" class="messages" id="hidden_cur_msg_box_id"><ul></ul></div>
    <span id="msg_box_id">
      {% include 'chat/msg_box.html' %}
    </span>
    <div class="message-input">
      <div class="wrap">
	<input type="text" placeholder="{% trans 'Write your message...' %}" />
	<!--i class="fa fa-paperclip attachment" aria-hidden="true"></i-->
	<button class="submit"><i class="fa fa-paper-plane" aria-hidden="true"></i></button>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block javascript %}
 <script>
 {% include 'chat/chat.js' %}
</script>
{% endblock %}
